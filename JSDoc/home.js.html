<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: home.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: home.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 * Initializes the map and retrieves store information from the API to display markers.
 * @function initializeMap
 */
$(document).ready(function() {

    // Map creation
    var map = L.map('map');
    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
        attribution: '&amp;copy; &lt;a href="https://www.openstreetmap.org/copyright">OpenStreetMap&lt;/a> contributors'
    }).addTo(map);

    // Array to store store latitude and longitude
    let storeLTLG = [];
    let nbStore = 0;
    let butStore = {};

    /**
     * Retrieves store data and creates buttons and markers for each store.
     * @function getStoreData
     */
    $.getJSON("https://dev-plantiv221.users.info.unicaen.fr/bikestores/stores", async function(data) {

        for (let store of data) {
            $("#but_stores").append("&lt;button type=\"button\" id=but" + nbStore + " class=\"btn btn-primary mx-1\">" + store["store_name"] + "&lt;/button>");
            await storeData(store);
        }

        // Event listeners for the buttons
        for (let i = 0; i &lt; 3; i++) {
            butStore["listener" + i] = $("#but" + i).on("click", function() {
                map.setView(butStore["marker" + i].getLatLng(), 18);
            });
        }
    });

    /**
     * Retrieves data for each store and creates markers on the map.
     * @function storeData
     * @param {Object} store - The store object.
     */
    async function storeData(store) {
        return new Promise((resolve) => {

            $.getJSON("https://nominatim.openstreetmap.org/search?format=json&amp;q=" + encodeURIComponent(store["street"]) + " " + encodeURIComponent(store["zip_code"]), async function(OSMdata) {

                butStore["marker" + nbStore] = L.marker([OSMdata[0]["lat"], OSMdata[0]["lon"]]);
                butStore["marker" + nbStore].addTo(map);

                nbStore++;
                resolve();
            });
        });
    }

    /**
     * Retrieves visitor IP and coordinates to create a marker on the map.
     * @function getUserLocation
     */
    $.getJSON("https://api-bdc.net/data/client-ip", function(data) {

        let ip = data["ipString"];

        $.getJSON("https://api.apibundle.io/ip-lookup?apikey=85ab91ee4fc2466d98e7a000e8277443&amp;ip=" + ip, function(data) {
            let userMarker = L.marker([data["latitude"], data["longitude"]]);
            userMarker.bindTooltip("Your location (based on your public IP)", {
                permanent: true,
                direction: 'top'
            }).openTooltip();
            userMarker.addTo(map);
            map.setView(userMarker.getLatLng(), 18);

        });
    });
});
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Global</h3><ul><li><a href="global.html#addContentToDatabase">addContentToDatabase</a></li><li><a href="global.html#addEmployeeOption">addEmployeeOption</a></li><li><a href="global.html#checkFill">checkFill</a></li><li><a href="global.html#checkFormat">checkFormat</a></li><li><a href="global.html#clientLogin">clientLogin</a></li><li><a href="global.html#deleteContent">deleteContent</a></li><li><a href="global.html#displayItemList">displayItemList</a></li><li><a href="global.html#employeeLogin">employeeLogin</a></li><li><a href="global.html#getCookie">getCookie</a></li><li><a href="global.html#getEmployeesList">getEmployeesList</a></li><li><a href="global.html#getStoreData">getStoreData</a></li><li><a href="global.html#getUserLocation">getUserLocation</a></li><li><a href="global.html#initializeMap">initializeMap</a></li><li><a href="global.html#selectItemChange">selectItemChange</a></li><li><a href="global.html#selectStoreChange">selectStoreChange</a></li><li><a href="global.html#selectTypeChange">selectTypeChange</a></li><li><a href="global.html#singular">singular</a></li><li><a href="global.html#sortTable">sortTable</a></li><li><a href="global.html#storeData">storeData</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 4.0.2</a> on Thu Apr 18 2024 16:39:57 GMT+0200 (heure d’été d’Europe centrale)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
